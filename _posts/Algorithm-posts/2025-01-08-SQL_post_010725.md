---
title: "[프로그래머스] 5월 식품들의 총매출 조회하기 - SQL"
date: 2025-01-07  
categories: [코딩테스트 연습, SQL코테]
tags: [SQL, GROUP BY]
layout: post
author: mongblang
---

# 📌&nbsp; **프로그래머스 SQL 고득점 Kit - JOIN 문제 8**
[문제 링크](https://school.programmers.co.kr/learn/courses/30/lessons/131117)  

# 📝&nbsp; **문제**
---
![problem](/assets/img/codingtest-post-img/PGSQL_join8-1.png)
![problem2](/assets/img/codingtest-post-img/PGSQL_join8-2.png)


## ✏️&nbsp; **입출력 예시**
---
![problem3](/assets/img/codingtest-post-img/PGSQL_join8-3.png)
![problem4](/assets/img/codingtest-post-img/PGSQL_join8-4.png)



&nbsp;  

&nbsp;   

## **내 풀이**  
---  

```sql
SELECT A.PRODUCT_ID, A.PRODUCT_NAME, SUM(A.PRICE * B.AMOUNT) AS TOTAL_SALES
FROM FOOD_PRODUCT A JOIN FOOD_ORDER B ON A.PRODUCT_ID =  B.PRODUCT_ID
WHERE B.PRODUCE_DATE <= '2022-05-31' AND B.PRODUCE_DATE >= '2022-05-01'
GROUP BY A.PRODUCT_ID
ORDER BY TOTAL_SALES DESC, PRODUCT_ID
```

#### **코드 해설**
1. 식품 정보 테이블과 식품 주문 테이블을 상품ID를 기준으로 이너조인한다.
2. 식품 주문 테이블의 생산 날짜가 5월 이내인 데이터들만 필터링한다.
3. 식품ID를 기준으로 그룹하고 단가와 주문량을 곱한 값의 합계를 총 매출로 정의한다.
4. 총 매출을 기준으로 내림차순 정렬하고, 총 매출이 같은 경우 상품ID를 오름차순 정렬해 상품ID, 상품명, 총매출을 반환한다. 

&nbsp;   

