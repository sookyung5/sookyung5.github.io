---
title: "[프로그래머스] 조건에 맞는 사용자와 총 거래금액 조회하기 - SQL"
date: 2025-01-14  
categories: [코딩테스트 연습, SQL코테]
tags: [SQL, GROUP BY]
layout: post
author: mongblang
---

# 📌&nbsp; **프로그래머스 SQL 고득점 Kit - GROUP BY 문제 6**
[문제 링크](https://school.programmers.co.kr/learn/courses/30/lessons/164668)  

# 📝&nbsp; **문제**
---
![problem](/assets/img/codingtest-post-img/PGSQL_groupby6-1.png)
![problem2](/assets/img/codingtest-post-img/PGSQL_groupby6-2.png)


## ✏️&nbsp; **입출력 예시**
---
![example](/assets/img/codingtest-post-img/PGSQL_groupby6-3.png)
![example2](/assets/img/codingtest-post-img/PGSQL_groupby6-4.png)




&nbsp;  

&nbsp;   

## **내 풀이**  
---  

```sql
SELECT B.USER_ID, B.NICKNAME, A.TOTAL_SALES
FROM (SELECT WRITER_ID, SUM(PRICE) AS TOTAL_SALES 
      FROM USED_GOODS_BOARD
      WHERE STATUS = 'DONE'
      GROUP BY WRITER_ID HAVING TOTAL_SALES >= 700000) A 
      JOIN USED_GOODS_USER B ON A.WRITER_ID = B.USER_ID
ORDER BY TOTAL_SALES
```

#### **코드 해설**
1. 서브쿼리를 사용해 `USED_GOODS_BOARD` 테이블에서 거래 완료된 게시물 중 작성자ID별로 총 거래액이 70만 원 이상인 데이터를 조회한다.
2. 해당 테이블을 `USED_GOODS_USER` 테이블에 ID를 기준으로 조인한다. (작성자ID=사용자ID)
3. 조인한 테이블에서 사용자ID, 닉네임, 총 거래액을 조회하고 총 거래액을 기준으로 오름차순 정렬한다. 

&nbsp;   

