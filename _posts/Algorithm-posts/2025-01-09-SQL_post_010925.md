---
title: "[프로그래머스] 그룹별 조건에 맞는 식당 목록 출력하기 - SQL"
date: 2025-01-09  
categories: [코딩테스트 연습, SQL코테]
tags: [SQL, GROUP BY]
layout: post
author: mongblang
---

# 📌&nbsp; **프로그래머스 SQL 고득점 Kit - JOIN 문제 9**
[문제 링크](https://school.programmers.co.kr/learn/courses/30/lessons/131124)  

# 📝&nbsp; **문제**
---
![problem](/assets/img/codingtest-post-img/PGSQL_join9-1.png)
![problem2](/assets/img/codingtest-post-img/PGSQL_join9-2.png)


## ✏️&nbsp; **입출력 예시**
---
![problem3](/assets/img/codingtest-post-img/PGSQL_join9-3.png)



&nbsp;  

&nbsp;   

## **내 풀이**  
---  

```sql
SELECT A.MEMBER_NAME, B.REVIEW_TEXT, DATE_FORMAT(B.REVIEW_DATE, '%Y-%m-%d') AS REVIEW_DATE
FROM MEMBER_PROFILE A JOIN REST_REVIEW B ON A.MEMBER_ID = B.MEMBER_ID
WHERE A.MEMBER_ID = (SELECT MEMBER_ID
                    FROM REST_REVIEW
                    GROUP BY MEMBER_ID
                    ORDER BY COUNT(*) DESC
                    LIMIT 1)
ORDER BY REVIEW_DATE, B.REVIEW_TEXT
```

#### **코드 해설**
1. 회원정보 테이블과 리뷰 테이블을 회원ID를 기준으로 이너조인한다.
2. 가장 리뷰를 많이 작성한 한 명의 리뷰만 조회해야 하기 때문에 where절에 서브쿼리로 리뷰 수를 기준으로 정렬한 후 가장 위에 있는 사람 1명의 회원ID를 가져와 필터링한다. 
3. 회원이름, 리뷰 내용, 작성 날짜 (dateformat 함수 사용해 지정한 형식으로 맞춤)를 조회할 때, 작성일>리뷰 기준으로 각각 오름차순 정렬한다.

&nbsp;   

근데 이 코드를 작성하며 한 가지 의문이 들었다. 서브쿼리를 활용해 가장 리뷰를 많이 작성한 회원을 조회했을 때, 리뷰를 가장 많이 작성한 회원이 여러명이었다.  
그래서 LIMIT 1을 사용하지 않고 가장 리뷰를 많이 쓴 회원들의 리뷰가 조회되도록 쿼리를 작성해봤는데, 어째서인지 정답처리가 됐다.      


```sql
SELECT A.MEMBER_NAME, B.REVIEW_TEXT, DATE_FORMAT(B.REVIEW_DATE, '%Y-%m-%d') AS REVIEW_DATE
FROM MEMBER_PROFILE A JOIN REST_REVIEW B ON A.MEMBER_ID = B.MEMBER_ID
WHERE A.MEMBER_ID = (SELECT MEMBER_ID
                    FROM REST_REVIEW
                    GROUP BY MEMBER_ID
                    ORDER BY COUNT(*) DESC
                    LIMIT 1)
ORDER BY REVIEW_DATE, B.REVIEW_TEXT
```

&nbsp;   

