---
title: "[프로그래머스] 저자 별 카테고리 별 매출액 집계하기 - SQL"
date: 2025-01-20  
categories: [코딩테스트 연습, SQL코테]
tags: [SQL, GROUP BY]
layout: post
author: mongblang
---

# 📌&nbsp; **프로그래머스 SQL 고득점 Kit - GROUP BY 문제 10**
[문제 링크](https://school.programmers.co.kr/learn/courses/30/lessons/144856)  

# 📝&nbsp; **문제**
---
![problem](/assets/img/codingtest-post-img/PGSQL_groupby10-1.png)
![problem2](/assets/img/codingtest-post-img/PGSQL_groupby10-2.png)

## ✏️&nbsp; **입출력 예시**
---
![example](/assets/img/codingtest-post-img/PGSQL_groupby10-3.png)
![example2](/assets/img/codingtest-post-img/PGSQL_groupby10-4.png)




&nbsp;  

&nbsp;   

## **내 풀이**  
---  

```sql
SELECT A.AUTHOR_ID, A.AUTHOR_NAME, B.CATEGORY, SUM((C.SALES*B.PRICE)) AS TOTAL_SALES
FROM AUTHOR A JOIN BOOK B ON A.AUTHOR_ID = B.AUTHOR_ID
     JOIN BOOK_SALES C ON B.BOOK_ID = C.BOOK_ID
WHERE YEAR(C.SALES_DATE) = 2022 AND MONTH(C.SALES_DATE) = 1
GROUP BY A.AUTHOR_ID, A.AUTHOR_NAME, B.CATEGORY
ORDER BY A.AUTHOR_ID ASC, B.CATEGORY DESC
```

#### **코드 해설**
1. 문제에 주어진 세 테이블을 모두 이너조인한다. 저자 테이블과 도서 테이블은 저자 아이디를 기준으로, 도서 테이블과 매출 테이블은 도서코드로 조인한다.
2. 날짜함수를 사용해 2022년 1월 매출만 필터링한다.
3. 확인하고 싶은 컬럼들을 기준으로 그룹화하고 (저자ID, 이름, 카테고리) 집계함수를 사용해 총 매출을 계산한다.
4. 저자ID를 기준으로 오름차순하고, 같다면 카테고리를 기준으로 내림차순 정렬한다. 

&nbsp;   

